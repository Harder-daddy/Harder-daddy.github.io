<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>äº•å­—æ£‹ï¼ˆå‹åˆ©ç‰¹æ•ˆç‰ˆï¼‰</title>

<style>
body {
    font-family: Arial, sans-serif;
    margin: 0;
    background: #fafafa;
    display: flex;
    height: 100vh;
}

/* å·¦å´ */
#sidebar {
    width: 240px;
    background: #fff;
    border-right: 2px solid #ccc;
    padding: 20px;
}

button {
    width: 100%;
    padding: 12px;
    font-size: 16px;
    cursor: pointer;
}

/* æ£‹ç›¤å€ */
#game-container {
    flex: 1;
    display: flex;
    justify-content: flex-end;
    align-items: flex-start;
    padding: 30px;
    position: relative;
}

#board {
    display: grid;
    grid-template-columns: repeat(3, 100px);
    grid-template-rows: repeat(3, 100px);
    gap: 5px;
}

.cell {
    width: 100px;
    height: 100px;
    border: 2px solid #333;
    font-size: 60px;
    display: flex;
    justify-content: center;
    align-items: center;
    background: #fff;
}

.cell.win {
    background: #ffe066;
    animation: pop 0.4s ease-in-out infinite alternate;
}

@keyframes pop {
    from { transform: scale(1); }
    to { transform: scale(1.1); }
}

/* é®ç½© */
#overlay {
    position: absolute;
    inset: 0;
    background: rgba(0,0,0,0.6);
    display: none;
    justify-content: center;
    align-items: center;
}

/* å½ˆçª— */
#modal {
    background: #fff;
    padding: 30px 40px;
    border-radius: 10px;
    text-align: center;
    animation: fadeIn 0.4s ease;
}

@keyframes fadeIn {
    from { transform: scale(0.7); opacity: 0; }
    to { transform: scale(1); opacity: 1; }
}

/* ç²’å­ */
.particle {
    position: absolute;
    width: 10px;
    height: 10px;
    background: gold;
    border-radius: 50%;
    animation: explode 1s ease-out forwards;
}

@keyframes explode {
    to {
        transform: translate(var(--x), var(--y));
        opacity: 0;
    }
}
</style>
</head>
<body>

<div id="sidebar">
    <h3>ğŸ¤– äººæ©Ÿå°æˆ°</h3>
    <button id="resetBtn">é‡æ–°é–‹å§‹</button>
</div>

<div id="game-container">
    <div id="board"></div>

    <!-- å‹åˆ©ç‰¹æ•ˆ -->
    <div id="overlay">
        <div id="modal">
            <h2 id="resultText"></h2>
            <button onclick="resetGame()">å†ç©ä¸€æ¬¡</button>
        </div>
    </div>
</div>

<script>
const boardEl = document.getElementById("board");
const overlay = document.getElementById("overlay");
const resultText = document.getElementById("resultText");

let board = Array(9).fill("");
let gameOver = false;

const winPatterns = [
    [0,1,2],[3,4,5],[6,7,8],
    [0,3,6],[1,4,7],[2,5,8],
    [0,4,8],[2,4,6]
];

function createBoard() {
    boardEl.innerHTML = "";
    board.forEach((val, idx) => {
        const cell = document.createElement("div");
        cell.className = "cell";
        cell.textContent = val;
        cell.onclick = () => playerMove(idx);
        boardEl.appendChild(cell);
    });
}

function playerMove(i) {
    if (board[i] || gameOver) return;
    board[i] = "X";
    createBoard();
    if (checkEnd("X")) return;
    setTimeout(aiMove, 400);
}

function aiMove() {
    const move = randomMove();
    board[move] = "O";
    createBoard();
    checkEnd("O");
}

function randomMove() {
    const empty = board.map((v,i)=>v===""?i:null).filter(v=>v!==null);
    return empty[Math.floor(Math.random()*empty.length)];
}

function checkEnd(player) {
    const winLine = checkWin(player);
    if (winLine) {
        showWin(player, winLine);
        return true;
    }
    if (!board.includes("")) {
        showDraw();
        return true;
    }
    return false;
}

function checkWin(player) {
    for (const p of winPatterns) {
        if (p.every(i => board[i] === player)) return p;
    }
    return null;
}

function showWin(player, line) {
    gameOver = true;

    // é«˜äº®å‹åˆ©æ ¼
    line.forEach(i => {
        boardEl.children[i].classList.add("win");
        createParticles(boardEl.children[i]);
    });

    resultText.textContent = player === "X" ? "ğŸ‰ ä½ è´äº†ï¼" : "ğŸ¤– é›»è…¦å‹åˆ©";
    overlay.style.display = "flex";
}

function showDraw() {
    gameOver = true;
    resultText.textContent = "ğŸ¤ å¹³æ‰‹";
    overlay.style.display = "flex";
}

function createParticles(cell) {
    const rect = cell.getBoundingClientRect();
    for (let i = 0; i < 10; i++) {
        const p = document.createElement("div");
        p.className = "particle";
        p.style.left = rect.left + rect.width / 2 + "px";
        p.style.top = rect.top + rect.height / 2 + "px";
        p.style.setProperty("--x", `${(Math.random()-0.5)*200}px`);
        p.style.setProperty("--y", `${(Math.random()-0.5)*200}px`);
        document.body.appendChild(p);
        setTimeout(() => p.remove(), 1000);
    }
}

function resetGame() {
    board = Array(9).fill("");
    gameOver = false;
    overlay.style.display = "none";
    createBoard();
}

document.getElementById("resetBtn").onclick = resetGame;

createBoard();
</script>

</body>
</html>
